# –¢–µ—Ö–Ω–∏—á–µ—Å–∫–æ–µ —Ä–µ—à–µ–Ω–∏–µ MVP: Telegram Stars Shop

## –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ  User (TG)  ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
       ‚îÇ
       ‚ñº
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê      ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ  Telegram Bot   ‚îÇ‚óÑ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§  Bot API     ‚îÇ
‚îÇ  (Inline Buttons)‚îÇ      ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
         ‚îÇ
         ‚ñº
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê      ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ  Backend API    ‚îÇ‚óÑ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§  Database    ‚îÇ
‚îÇ  (NestJS)       ‚îÇ      ‚îÇ  (PostgreSQL) ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò      ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
         ‚îÇ
         ‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
         ‚ñº              ‚ñº
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ Fragment API ‚îÇ  ‚îÇ YooKassa API ‚îÇ
‚îÇ   (TON)      ‚îÇ  ‚îÇ  (–°–ë–ü/–ö–∞—Ä—Ç—ã) ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

**–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ:** Mini App –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ, –µ—Å–ª–∏ –±—É–¥–µ—Ç –≤—Ä–µ–º—è. –û—Å–Ω–æ–≤–Ω–æ–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å ‚Äî inline –∫–Ω–æ–ø–∫–∏ –≤ Telegram –±–æ—Ç–µ.

---

## –¢–µ—Ö–Ω–æ–ª–æ–≥–∏—á–µ—Å–∫–∏–π —Å—Ç–µ–∫

### Backend
- **–Ø–∑—ã–∫:** TypeScript
- **–§—Ä–µ–π–º–≤–æ—Ä–∫:** NestJS
- **–ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö:** PostgreSQL
- **ORM:** TypeORM
- **–û—á–µ—Ä–µ–¥–∏ –∑–∞–¥–∞—á:** –ù–µ –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è (–Ω–∏–∑–∫–∞—è –Ω–∞–≥—Ä—É–∑–∫–∞, —Å–∏–Ω—Ö—Ä–æ–Ω–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–∞)

### Frontend (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
- **Mini App:** React/Vue 3 (–µ—Å–ª–∏ –±—É–¥–µ—Ç –≤—Ä–µ–º—è)
- **–û—Å–Ω–æ–≤–Ω–æ–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å:** Inline –∫–Ω–æ–ø–∫–∏ –≤ Telegram –±–æ—Ç–µ

### –ò–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–∞
- **–•–æ—Å—Ç–∏–Ω–≥:** DigitalOcean
- **–ö–æ–Ω—Ç–µ–π–Ω–µ—Ä–∏–∑–∞—Ü–∏—è:** Docker
- **CI/CD:** GitHub Actions —Å —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—ã–º —Ä–∞–Ω–Ω–µ—Ä–æ–º
- **–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥:** Grafana (dashboard.onezee.ru)

---

## –û—Å–Ω–æ–≤–Ω—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã (NestJS –º–æ–¥—É–ª–∏)

### 1. Telegram Bot Module (`/src/bot/`)

```typescript
// NestJS –º–æ–¥—É–ª—å –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å Telegram Bot API
- bot.module.ts
- bot.service.ts      // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –±–æ—Ç–∞, –æ–±—Ä–∞–±–æ—Ç–∫–∞ –∫–æ–º–∞–Ω–¥
- bot.controller.ts   // Webhook endpoint –æ—Ç Telegram
- commands/
  - start.command.ts
  - help.command.ts
  - status.command.ts
- handlers/
  - callback.handler.ts  // –û–±—Ä–∞–±–æ—Ç–∫–∞ inline –∫–Ω–æ–ø–æ–∫
```

**–ö–æ–º–∞–Ω–¥—ã:**
- `/start` - –ø—Ä–∏–≤–µ—Ç—Å—Ç–≤–∏–µ, –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è, –≤—ã–±–æ—Ä –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ Stars (inline –∫–Ω–æ–ø–∫–∏)
- `/help` - —Å–ø—Ä–∞–≤–∫–∞
- `/status` - —Å—Ç–∞—Ç—É—Å –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ –∑–∞–∫–∞–∑–∞

**Inline –∫–Ω–æ–ø–∫–∏:**
- –í—ã–±–æ—Ä –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ Stars (100, 500, 1000, 5000, 10000)
- –í—ã–±–æ—Ä –ø–æ–ª—É—á–∞—Ç–µ–ª—è Stars (—Å–µ–±–µ / –¥—Ä—É–≥–æ–º—É –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é)
- –ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ –∑–∞–∫–∞–∑–∞
- –û—Ç–º–µ–Ω–∞ –∑–∞–∫–∞–∑–∞

**–î–∏–∞–ª–æ–≥ –≤—ã–±–æ—Ä–∞ –ø–æ–ª—É—á–∞—Ç–µ–ª—è:**
1. –ü–æ—Å–ª–µ –≤—ã–±–æ—Ä–∞ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ Stars ‚Üí –≤—ã–±–æ—Ä –ø–æ–ª—É—á–∞—Ç–µ–ª—è (—Å–µ–±–µ/–¥—Ä—É–≥–æ–º—É)
2. –ï—Å–ª–∏ "—Å–µ–±–µ":
   - –ü—Ä–æ–≤–µ—Ä–∫–∞ username —á–µ—Ä–µ–∑ `getChat` Bot API
   - –ï—Å–ª–∏ username –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç ‚Üí —Å–æ–æ–±—â–µ–Ω–∏–µ —Å –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–µ–π –ø–æ —É—Å—Ç–∞–Ω–æ–≤–∫–µ username
   - –ï—Å–ª–∏ username –µ—Å—Ç—å ‚Üí –ø—Ä–æ–¥–æ–ª–∂–µ–Ω–∏–µ –æ—Ñ–æ—Ä–º–ª–µ–Ω–∏—è –∑–∞–∫–∞–∑–∞
3. –ï—Å–ª–∏ "–¥—Ä—É–≥–æ–º—É":
   - –ó–∞–ø—Ä–æ—Å –Ω–∞ –≤–≤–æ–¥ username (–±–µ–∑ @)
   - –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—É—â–µ—Å—Ç–≤–æ–≤–∞–Ω–∏—è —á–µ—Ä–µ–∑ Fragment API
   - –ï—Å–ª–∏ username –Ω–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç ‚Üí –æ—à–∏–±–∫–∞ –∏ –∑–∞–ø—Ä–æ—Å –Ω–∞ –ø–æ–≤—Ç–æ—Ä–Ω—ã–π –≤–≤–æ–¥
   - –ï—Å–ª–∏ username —Å—É—â–µ—Å—Ç–≤—É–µ—Ç ‚Üí –ø—Ä–æ–¥–æ–ª–∂–µ–Ω–∏–µ –æ—Ñ–æ—Ä–º–ª–µ–Ω–∏—è –∑–∞–∫–∞–∑–∞

### 2. Orders Module (`/src/orders/`)

```typescript
// NestJS –º–æ–¥—É–ª—å –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∑–∞–∫–∞–∑–∞–º–∏
- orders.module.ts
- orders.service.ts
- orders.controller.ts
- entities/order.entity.ts
- dto/create-order.dto.ts
```

**Endpoints:**
- `POST /api/orders` - —Å–æ–∑–¥–∞–Ω–∏–µ –∑–∞–∫–∞–∑–∞
- `GET /api/orders/:id` - —Å—Ç–∞—Ç—É—Å –∑–∞–∫–∞–∑–∞
- `GET /api/orders/user/:telegramId` - –∏—Å—Ç–æ—Ä–∏—è –∑–∞–∫–∞–∑–æ–≤ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

### 3. Payment Module (`/src/payment/`)

```typescript
// NestJS –º–æ–¥—É–ª—å –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å —ç–∫–≤–∞–π—Ä–∏–Ω–≥–æ–º (YooKassa)
- payment.module.ts
- payment.service.ts      // –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å YooKassa API
- payment.controller.ts   // Webhook endpoint –æ—Ç YooKassa
- yookassa/
  - yookassa.service.ts    // –ö–ª–∏–µ–Ω—Ç –¥–ª—è YooKassa API
  - yookassa.dto.ts        // DTO –¥–ª—è YooKassa
```

**Endpoints:**
- `POST /api/payment/create` - —Å–æ–∑–¥–∞–Ω–∏–µ –ø–ª–∞—Ç–µ–∂–∞
- `POST /api/payment/webhook` - webhook –æ—Ç YooKassa
- `GET /api/payment/:id` - —Å—Ç–∞—Ç—É—Å –ø–ª–∞—Ç–µ–∂–∞

**–°–ø–æ—Å–æ–±—ã –æ–ø–ª–∞—Ç—ã —á–µ—Ä–µ–∑ YooKassa:**
- –°–ë–ü (–°–∏—Å—Ç–µ–º–∞ –±—ã—Å—Ç—Ä—ã—Ö –ø–ª–∞—Ç–µ–∂–µ–π)
- –ë–∞–Ω–∫–æ–≤—Å–∫–∏–µ –∫–∞—Ä—Ç—ã
- –î—Ä—É–≥–∏–µ –º–µ—Ç–æ–¥—ã, –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ–º—ã–µ YooKassa

### 4. Fragment Module (`/src/fragment/`)

```typescript
// NestJS –º–æ–¥—É–ª—å –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å Fragment API
// –î–µ—Ç–∞–ª–∏ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ –±—É–¥—É—Ç –æ–ø–∏—Å–∞–Ω—ã –æ—Ç–¥–µ–ª—å–Ω–æ
- fragment.module.ts
- fragment.service.ts
```

**–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ:** –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å Fragment API —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–∞ —á–µ—Ä–µ–∑ –æ—Ç–¥–µ–ª—å–Ω—ã–π —Å–∫—Ä–∏–ø—Ç. –î–µ—Ç–∞–ª—å–Ω–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ –±—É–¥–µ—Ç –¥–æ–±–∞–≤–ª–µ–Ω–æ –ø–æ–∑–∂–µ.

### 5. Notifications Module (`/src/notifications/`)

```typescript
// NestJS –º–æ–¥—É–ª—å –¥–ª—è –æ—Ç–ø—Ä–∞–≤–∫–∏ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π –≤ Telegram –≥—Ä—É–ø–ø—É
- notifications.module.ts
- notifications.service.ts      // –û—Ç–ø—Ä–∞–≤–∫–∞ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π –≤ –≥—Ä—É–ø–ø—É
- notifications.controller.ts   // –û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ: API –¥–ª—è —Ä—É—á–Ω—ã—Ö —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π
- types/
  - notification.types.ts       // –¢–∏–ø—ã —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π
```

**–¢–∏–ø—ã —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π:**

1. **–£—Å–ø–µ—à–Ω—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏:**
   - –£—Å–ø–µ—à–Ω–∞—è –ø–æ–∫—É–ø–∫–∞ Stars (–ø–æ–∑–¥—Ä–∞–≤–ª–µ–Ω–∏–µ)
   - –£—Å–ø–µ—à–Ω–∞—è –æ–ø–ª–∞—Ç–∞ –∑–∞–∫–∞–∑–∞
   - –£—Å–ø–µ—à–Ω–∞—è –æ—Ç–ø—Ä–∞–≤–∫–∞ Stars –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é

2. **–ö—Ä–∏—Ç–∏—á–Ω—ã–µ –æ—à–∏–±–∫–∏:**
   - –û—à–∏–±–∫–∞ –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ –ø–ª–∞—Ç–µ–∂–∞ –≤ YooKassa
   - –û—à–∏–±–∫–∞ –ø—Ä–∏ –ø–æ–∫—É–ø–∫–µ Stars —á–µ—Ä–µ–∑ Fragment
   - –ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ TON –Ω–∞ –∫–æ—à–µ–ª—å–∫–µ
   - –û—à–∏–±–∫–∞ –≤–æ–∑–≤—Ä–∞—Ç–∞ —Å—Ä–µ–¥—Å—Ç–≤
   - Fragment API –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω

3. **–ü—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è:**
   - –ü–æ—Ç–µ—Ä—è webhook –æ—Ç YooKassa
   - –ú–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ –æ—à–∏–±–∫–∏ –ø—Ä–æ–≤–µ—Ä–∫–∏ username
   - –ù–µ —É–¥–∞–ª–æ—Å—å –æ—Ç–ø—Ä–∞–≤–∏—Ç—å Stars (–ø–æ—Å–ª–µ 3 –ø–æ–ø—ã—Ç–æ–∫)

4. **–ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏–æ–Ω–Ω—ã–µ:**
   - –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∑–∞ –¥–µ–Ω—å/–Ω–µ–¥–µ–ª—é
   - –î–æ—Å—Ç–∏–∂–µ–Ω–∏–µ –º–µ—Ç—Ä–∏–∫ (–Ω–∞–ø—Ä–∏–º–µ—Ä, 10 –ø—Ä–æ–¥–∞–∂)

**–ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è:**
- ID Telegram –≥—Ä—É–ø–ø—ã –¥–ª—è —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π (–∏–∑ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è)
- –ë–æ—Ç –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –¥–æ–±–∞–≤–ª–µ–Ω –≤ –≥—Ä—É–ø–ø—É –∫–∞–∫ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä
- –§–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–æ–æ–±—â–µ–Ω–∏–π —Å —ç–º–æ–¥–∑–∏ –¥–ª—è –ª—É—á—à–µ–π —á–∏—Ç–∞–µ–º–æ—Å—Ç–∏

**–ú–æ–º–µ–Ω—Ç—ã –æ—Ç–ø—Ä–∞–≤–∫–∏ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π:**

1. **–ü—Ä–∏ —É—Å–ø–µ—à–Ω–æ–π –ø–æ–∫—É–ø–∫–µ (status: COMPLETED):**
   - –û—Ç–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è —Å—Ä–∞–∑—É –ø–æ—Å–ª–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è —Å—Ç–∞—Ç—É—Å–∞ –∑–∞–∫–∞–∑–∞
   - –°–æ–¥–µ—Ä–∂–∏—Ç –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ, –∫–æ–ª–∏—á–µ—Å—Ç–≤–µ Stars, –ø–æ–ª—É—á–∞—Ç–µ–ª–µ, —Å—É–º–º–µ

2. **–ü—Ä–∏ –∫—Ä–∏—Ç–∏—á–Ω—ã—Ö –æ—à–∏–±–∫–∞—Ö:**
   - –û—Ç–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è —Å—Ä–∞–∑—É –ø—Ä–∏ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏–∏ –æ—à–∏–±–∫–∏
   - –ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ TON ‚Üí –ø—Ä–æ–≤–µ—Ä–∫–∞ –±–∞–ª–∞–Ω—Å–∞ –ø–µ—Ä–µ–¥ –ø–æ–∫—É–ø–∫–æ–π Stars
   - –û—à–∏–±–∫–∞ YooKassa ‚Üí –ø–æ—Å–ª–µ 3 –Ω–µ—É–¥–∞—á–Ω—ã—Ö –ø–æ–ø—ã—Ç–æ–∫ —Å–æ–∑–¥–∞–Ω–∏—è –ø–ª–∞—Ç–µ–∂–∞
   - –û—à–∏–±–∫–∞ Fragment ‚Üí —Å—Ä–∞–∑—É –ø—Ä–∏ –æ—à–∏–±–∫–µ –ø–æ–∫—É–ø–∫–∏ Stars
   - –û—à–∏–±–∫–∞ –≤–æ–∑–≤—Ä–∞—Ç–∞ —Å—Ä–µ–¥—Å—Ç–≤ ‚Üí —Å—Ä–∞–∑—É –ø—Ä–∏ –Ω–µ—É–¥–∞—á–Ω–æ–º refund

3. **–ü—Ä–∏ –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è—Ö:**
   - –ü–æ—Ç–µ—Ä—è webhook ‚Üí –ø–æ—Å–ª–µ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏—è –æ–ø–ª–∞—Ç—ã –±–µ–∑ webhook (—á–µ—Ä–µ–∑ polling)
   - Fragment API –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω ‚Üí –ø–æ—Å–ª–µ 5 –Ω–µ—É–¥–∞—á–Ω—ã—Ö –ø–æ–ø—ã—Ç–æ–∫ –ø–æ–¥—Ä—è–¥
   - –ù–µ —É–¥–∞–ª–æ—Å—å –æ—Ç–ø—Ä–∞–≤–∏—Ç—å Stars ‚Üí –ø–æ—Å–ª–µ 3 –Ω–µ—É–¥–∞—á–Ω—ã—Ö –ø–æ–ø—ã—Ç–æ–∫ –æ—Ç–ø—Ä–∞–≤–∫–∏

4. **–ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏–æ–Ω–Ω—ã–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è:**
   - –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ ‚Üí –ø–æ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—é (–Ω–∞–ø—Ä–∏–º–µ—Ä, —Ä–∞–∑ –≤ –¥–µ–Ω—å –≤ 00:00)
   - –î–æ—Å—Ç–∏–∂–µ–Ω–∏–µ –º–µ—Ç—Ä–∏–∫ ‚Üí —Å—Ä–∞–∑—É –ø—Ä–∏ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–∏ (–Ω–∞–ø—Ä–∏–º–µ—Ä, 10 –ø—Ä–æ–¥–∞–∂)

**–ü—Ä–∏–º–µ—Ä—ã —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π:**

```typescript
// –£—Å–ø–µ—à–Ω–∞—è –ø–æ–∫—É–ø–∫–∞
üéâ –ù–æ–≤–∞—è –ø–æ–∫—É–ø–∫–∞ Stars!
üë§ –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å: @username
‚≠ê –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ: 1,000 Stars
üéØ –ü–æ–ª—É—á–∞—Ç–µ–ª—å: @recipient_username
üí∞ –°—É–º–º–∞: 1,244 ‚ÇΩ
üïê –í—Ä–µ–º—è: 19.12.2025 15:30
üìã –ó–∞–∫–∞–∑: #abc-123

// –ö—Ä–∏—Ç–∏—á–Ω–∞—è –æ—à–∏–±–∫–∞ - –Ω–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ TON
üö® –ö—Ä–∏—Ç–∏—á–Ω–∞—è –æ—à–∏–±–∫–∞: –ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ TON –Ω–∞ –∫–æ—à–µ–ª—å–∫–µ
üíµ –¢–µ–∫—É—â–∏–π –±–∞–ª–∞–Ω—Å: 0.5 TON
üíµ –¢—Ä–µ–±—É–µ—Ç—Å—è: 1.2 TON
üìã –ó–∞–∫–∞–∑ ID: abc-123
‚ö†Ô∏è –¢—Ä–µ–±—É–µ—Ç—Å—è —Å—Ä–æ—á–Ω–æ–µ –ø–æ–ø–æ–ª–Ω–µ–Ω–∏–µ –∫–æ—à–µ–ª—å–∫–∞!

// –ö—Ä–∏—Ç–∏—á–Ω–∞—è –æ—à–∏–±–∫–∞ - YooKassa
üö® –û—à–∏–±–∫–∞ YooKassa
‚ùå –ù–µ —É–¥–∞–ª–æ—Å—å —Å–æ–∑–¥–∞—Ç—å –ø–ª–∞—Ç–µ–∂
üìã –ó–∞–∫–∞–∑ ID: abc-123
üë§ –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å: @username
üîÑ –ü–æ–ø—ã—Ç–æ–∫: 3
‚ö†Ô∏è –¢—Ä–µ–±—É–µ—Ç—Å—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞—Å—Ç—Ä–æ–µ–∫ YooKassa

// –ö—Ä–∏—Ç–∏—á–Ω–∞—è –æ—à–∏–±–∫–∞ - Fragment API
üö® –û—à–∏–±–∫–∞ Fragment API
‚ùå –ù–µ —É–¥–∞–ª–æ—Å—å –∫—É–ø–∏—Ç—å Stars
üìã –ó–∞–∫–∞–∑ ID: abc-123
üë§ –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å: @username
üíµ –°—É–º–º–∞: 1,244 ‚ÇΩ
‚ö†Ô∏è –¢—Ä–µ–±—É–µ—Ç—Å—è —Ä—É—á–Ω–æ–µ –≤–º–µ—à–∞—Ç–µ–ª—å—Å—Ç–≤–æ

// –ü—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ - –ø–æ—Ç–µ—Ä—è webhook
‚ö†Ô∏è –ü—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ: –ü–æ—Ç–µ—Ä—è webhook –æ—Ç YooKassa
üìã –ó–∞–∫–∞–∑ ID: abc-123
üí≥ –ü–ª–∞—Ç–µ–∂ ID: payment_123
‚úÖ –ü–ª–∞—Ç–µ–∂ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥—ë–Ω —á–µ—Ä–µ–∑ polling
‚ÑπÔ∏è Webhook –Ω–µ –±—ã–ª –¥–æ—Å—Ç–∞–≤–ª–µ–Ω

// –ü—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ - Fragment API –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω
‚ö†Ô∏è –ü—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ: Fragment API –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω
üîÑ –ü–æ–ø—ã—Ç–æ–∫: 5
‚ùå –ü–æ—Å–ª–µ–¥–Ω—è—è –æ—à–∏–±–∫–∞: Connection timeout
‚è±Ô∏è –í—Ä–µ–º—è: 19.12.2025 15:30
‚ö†Ô∏è –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å API

// –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏–æ–Ω–Ω–æ–µ - —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞
üìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∑–∞ –¥–µ–Ω—å (19.12.2025)
‚úÖ –£—Å–ø–µ—à–Ω—ã—Ö –ø–æ–∫—É–ø–æ–∫: 5
üí∞ –û–±—â–∞—è —Å—É–º–º–∞: 6,220 ‚ÇΩ
‚≠ê –í—Å–µ–≥–æ Stars: 5,000
‚è±Ô∏è –°—Ä–µ–¥–Ω–µ–µ –≤—Ä–µ–º—è –æ–±—Ä–∞–±–æ—Ç–∫–∏: 4 –º–∏–Ω
```

### 6. Database Schema (TypeORM)

```typescript
// entities/user.entity.ts
@Entity()
export class User {
  @PrimaryGeneratedColumn('uuid')
  id: string;

  @Column({ type: 'bigint', unique: true })
  telegramId: number;

  @Column({ nullable: true })
  username: string;

  @CreateDateColumn()
  createdAt: Date;

  @OneToMany(() => Order, order => order.user)
  orders: Order[];
}

// entities/order.entity.ts
@Entity()
export class Order {
  @PrimaryGeneratedColumn('uuid')
  id: string;

  @ManyToOne(() => User, user => user.orders)
  user: User;

  @Column()
  starsAmount: number;

  @Column('decimal', { precision: 10, scale: 2 })
  price: number;

  @Column({
    type: 'enum',
    enum: OrderStatus,
    default: OrderStatus.PENDING
  })
  status: OrderStatus;

  @Column({ nullable: true })
  recipientUsername: string;  // Username –ø–æ–ª—É—á–∞—Ç–µ–ª—è Stars (–±–µ–∑ @)

  @Column({ default: false })
  isSelfPurchase: boolean;    // true –µ—Å–ª–∏ –ø–æ–∫—É–ø–∫–∞ —Å–µ–±–µ, false –µ—Å–ª–∏ –¥—Ä—É–≥–æ–º—É

  @Column({ nullable: true, unique: true })
  paymentId: string;

  @Column({ nullable: true })
  fragmentTxId: string;

  @Column({ nullable: true })
  telegramTxId: string;

  @CreateDateColumn()
  createdAt: Date;

  @UpdateDateColumn()
  updatedAt: Date;
}

enum OrderStatus {
  PENDING = 'PENDING',
  PAID = 'PAID',
  PROCESSING = 'PROCESSING',
  COMPLETED = 'COMPLETED',
  FAILED = 'FAILED',
  CANCELLED = 'CANCELLED'
}
```

---

## –ü—Ä–æ—Ü–µ—Å—Å –ø–æ–∫—É–ø–∫–∏ (User Flow)

```
1. User ‚Üí /start –≤ –±–æ—Ç–µ
   ‚Üì
2. –ë–æ—Ç –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç inline –∫–Ω–æ–ø–∫–∏ —Å –≤–∞—Ä–∏–∞–Ω—Ç–∞–º–∏ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ Stars
   ‚Üì
3. User –≤—ã–±–∏—Ä–∞–µ—Ç –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ Stars ‚Üí –≤–∏–¥–∏—Ç —Ü–µ–Ω—É –≤ —Å–æ–æ–±—â–µ–Ω–∏–∏
   ‚Üì
4. –ë–æ—Ç —Å–ø—Ä–∞—à–∏–≤–∞–µ—Ç: "–ö–æ–º—É –æ—Ç–ø—Ä–∞–≤–∏—Ç—å Stars?" ‚Üí –∫–Ω–æ–ø–∫–∏ "–°–µ–±–µ" / "–î—Ä—É–≥–æ–º—É –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é"
   ‚Üì
5a. –ï—Å–ª–∏ "–°–µ–±–µ":
    - Backend –ø—Ä–æ–≤–µ—Ä—è–µ—Ç username —á–µ—Ä–µ–∑ getChat Bot API
    - –ï—Å–ª–∏ username –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç ‚Üí —Å–æ–æ–±—â–µ–Ω–∏–µ —Å –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–µ–π –ø–æ —É—Å—Ç–∞–Ω–æ–≤–∫–µ
    - –ï—Å–ª–∏ username –µ—Å—Ç—å ‚Üí —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –≤ Order (isSelfPurchase: true, recipientUsername: username)
    ‚Üì
5b. –ï—Å–ª–∏ "–î—Ä—É–≥–æ–º—É":
    - –ë–æ—Ç –∑–∞–ø—Ä–∞—à–∏–≤–∞–µ—Ç username (–±–µ–∑ @)
    - User –≤–≤–æ–¥–∏—Ç username
    - Backend –ø—Ä–æ–≤–µ—Ä—è–µ—Ç —Å—É—â–µ—Å—Ç–≤–æ–≤–∞–Ω–∏–µ —á–µ—Ä–µ–∑ Fragment API
    - –ï—Å–ª–∏ username –Ω–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç ‚Üí –æ—à–∏–±–∫–∞, –∑–∞–ø—Ä–æ—Å –Ω–∞ –ø–æ–≤—Ç–æ—Ä–Ω—ã–π –≤–≤–æ–¥
    - –ï—Å–ª–∏ username —Å—É—â–µ—Å—Ç–≤—É–µ—Ç ‚Üí —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –≤ Order (isSelfPurchase: false, recipientUsername: username)
    ‚Üì
6. User –Ω–∞–∂–∏–º–∞–µ—Ç "–ü–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç—å" ‚Üí Backend —Å–æ–∑–¥–∞—ë—Ç Order (status: PENDING)
   ‚Üì
7. Backend —Å–æ–∑–¥–∞—ë—Ç –ø–ª–∞—Ç–µ–∂ –≤ YooKassa ‚Üí –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Å—Å—ã–ª–∫—É –Ω–∞ –æ–ø–ª–∞—Ç—É
   ‚Üì
8. –ë–æ—Ç –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é —Å—Å—ã–ª–∫—É –Ω–∞ –æ–ø–ª–∞—Ç—É
   ‚Üì
9. User –æ–ø–ª–∞—á–∏–≤–∞–µ—Ç —á–µ—Ä–µ–∑ YooKassa (–°–ë–ü/–∫–∞—Ä—Ç–∞/–¥—Ä—É–≥–∏–µ –º–µ—Ç–æ–¥—ã)
   ‚Üì
10. YooKassa –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç webhook ‚Üí Backend –æ–±–Ω–æ–≤–ª—è–µ—Ç Order (status: PAID)
    ‚Üì
11. Backend —Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ –ø–æ–∫—É–ø–∞–µ—Ç Stars —á–µ—Ä–µ–∑ Fragment API –Ω–∞ recipientUsername
    ‚Üì
12. Fragment –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç transaction ID
    ‚Üì
13. –ï—Å–ª–∏ isSelfPurchase: true ‚Üí Backend –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç Stars –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é —á–µ—Ä–µ–∑ Telegram API
    –ï—Å–ª–∏ isSelfPurchase: false ‚Üí Stars —É–∂–µ –Ω–∞ –∞–∫–∫–∞—É–Ω—Ç–µ –ø–æ–ª—É—á–∞—Ç–µ–ª—è (—á–µ—Ä–µ–∑ Fragment)
    ‚Üì
14. Order –æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è (status: COMPLETED)
    ‚Üì
15. User –ø–æ–ª—É—á–∞–µ—Ç —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –≤ –±–æ—Ç–µ –æ –∑–∞–≤–µ—Ä—à–µ–Ω–∏–∏ –∑–∞–∫–∞–∑–∞
    ‚Üì
16. –£–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –≤ Telegram –≥—Ä—É–ø–ø—É: "üéâ –ù–æ–≤–∞—è –ø–æ–∫—É–ø–∫–∞! @username –∫—É–ø–∏–ª 1000 Stars"
```

---

## –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏

### Fragment API

–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å Fragment API —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–∞ —á–µ—Ä–µ–∑ –æ—Ç–¥–µ–ª—å–Ω—ã–π —Å–∫—Ä–∏–ø—Ç. –î–µ—Ç–∞–ª—å–Ω–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ API –∏ –ø—Ä–æ—Ü–µ—Å—Å–∞ –ø–æ–∫—É–ø–∫–∏ Stars –±—É–¥–µ—Ç –¥–æ–±–∞–≤–ª–µ–Ω–æ –ø–æ–∑–∂–µ.

**–ë–∞–∑–æ–≤—ã–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è:**
- KYC-–≤–µ—Ä–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –∞–∫–∫–∞—É–Ω—Ç
- TON –∫–æ—à–µ–ª—ë–∫ —Å –¥–æ—Å—Ç–∞—Ç–æ—á–Ω—ã–º –±–∞–ª–∞–Ω—Å–æ–º
- Telegram User ID –¥–ª—è –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏

**–ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—É—â–µ—Å—Ç–≤–æ–≤–∞–Ω–∏—è username:**
```typescript
// –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—É—â–µ—Å—Ç–≤–æ–≤–∞–Ω–∏—è username —á–µ—Ä–µ–∑ Fragment API
GET https://fragment.com/api/username/{username}
// –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ username –∏–ª–∏ –æ—à–∏–±–∫—É 404 –µ—Å–ª–∏ –Ω–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç
```

**–ü–æ–∫—É–ø–∫–∞ Stars –Ω–∞ username:**
```typescript
// –ü–æ–∫—É–ø–∫–∞ Stars –Ω–∞ —É–∫–∞–∑–∞–Ω–Ω—ã–π username
POST https://fragment.com/api/purchase
Body: {
  amount: number,
  currency: 'TON',
  recipientUsername: string  // Username –ø–æ–ª—É—á–∞—Ç–µ–ª—è (–±–µ–∑ @)
}
```

### Telegram Bot API

```typescript
// –û—Ç–ø—Ä–∞–≤–∫–∞ Stars –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é
POST https://api.telegram.org/bot{token}/sendStars
Body: {
  user_id: number,
  amount: number
}
```

### YooKassa (Payment Provider)

**–û—Å–Ω–æ–≤–Ω–æ–π —ç–∫–≤–∞–π—Ä–∏–Ω–≥:** YooKassa

**–ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã–µ —Å–ø–æ—Å–æ–±—ã –æ–ø–ª–∞—Ç—ã:**
- –°–ë–ü (–°–∏—Å—Ç–µ–º–∞ –±—ã—Å—Ç—Ä—ã—Ö –ø–ª–∞—Ç–µ–∂–µ–π)
- –ë–∞–Ω–∫–æ–≤—Å–∫–∏–µ –∫–∞—Ä—Ç—ã (Visa, MasterCard, –ú–ò–†)
- –î—Ä—É–≥–∏–µ –º–µ—Ç–æ–¥—ã, –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ–º—ã–µ YooKassa

**Webhook –æ–±—Ä–∞–±–æ—Ç–∫–∞:**
```typescript
POST /api/payment/webhook
// –í–∞–ª–∏–¥–∞—Ü–∏—è –ø–æ–¥–ø–∏—Å–∏ –æ—Ç YooKassa
// –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—Ç–∞—Ç—É—Å–∞ –∑–∞–∫–∞–∑–∞
// –°–∏–Ω—Ö—Ä–æ–Ω–Ω–∞—è –ø–æ–∫—É–ø–∫–∞ Stars —á–µ—Ä–µ–∑ Fragment API
```

---

## –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

### –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è

```env
# Telegram
TELEGRAM_BOT_TOKEN=
TELEGRAM_API_URL=https://api.telegram.org
TELEGRAM_NOTIFICATIONS_CHAT_ID=  # ID –≥—Ä—É–ø–ø—ã –¥–ª—è —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π (–±–æ—Ç –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–æ–º)

# Fragment
FRAGMENT_API_KEY=
FRAGMENT_TON_WALLET_PRIVATE_KEY=

# Database
DATABASE_URL=postgresql://user:password@localhost:5432/telegram_stars_db
TYPEORM_SYNCHRONIZE=false
TYPEORM_LOGGING=false

# YooKassa
YOOKASSA_SHOP_ID=
YOOKASSA_SECRET_KEY=
YOOKASSA_WEBHOOK_SECRET=

# App
NODE_ENV=production
PORT=3000
```

### –ó–∞—â–∏—Ç–∞ –¥–∞–Ω–Ω—ã—Ö
- –í—Å–µ –ø—Ä–∏–≤–∞—Ç–Ω—ã–µ –∫–ª—é—á–∏ –≤ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è
- –í–∞–ª–∏–¥–∞—Ü–∏—è –≤—Å–µ—Ö –≤—Ö–æ–¥—è—â–∏—Ö –¥–∞–Ω–Ω—ã—Ö (class-validator, DTO)
- Rate limiting –Ω–∞ API endpoints (NestJS Throttler)
- HTTPS –¥–ª—è –≤—Å–µ—Ö –∑–∞–ø—Ä–æ—Å–æ–≤
- –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –±–µ–∑ —á—É–≤—Å—Ç–≤–∏—Ç–µ–ª—å–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
- –í–∞–ª–∏–¥–∞—Ü–∏—è webhook –ø–æ–¥–ø–∏—Å–µ–π –æ—Ç YooKassa

---

## –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∏ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ

### –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ
- –°—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ (Winston/Pino)
- –û—Ç–¥–µ–ª—å–Ω—ã–µ –ª–æ–≥–∏ –¥–ª—è: –∑–∞–∫–∞–∑–æ–≤, –ø–ª–∞—Ç–µ–∂–µ–π, –æ—à–∏–±–æ–∫ Fragment API
- –õ–æ–≥–∏ –¥–æ—Å—Ç—É–ø–Ω—ã –≤ Grafana

### –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥
- **Grafana Dashboard:** dashboard.onezee.ru
- Health check endpoint: `GET /health`
- –ú–µ—Ç—Ä–∏–∫–∏: –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–∞–∫–∞–∑–æ–≤, —É—Å–ø–µ—à–Ω–æ—Å—Ç—å —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π, –≤—Ä–µ–º—è –æ–±—Ä–∞–±–æ—Ç–∫–∏, –æ—à–∏–±–∫–∏
- Grafana –ø–æ–¥–Ω–∏–º–∞–µ—Ç—Å—è –Ω–∞ —Ç–æ–º –∂–µ —Å–µ—Ä–≤–µ—Ä–µ, –ª–µ–≥–∫–æ –∏ –±—ã—Å—Ç—Ä–æ –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç—Å—è

---

## –î–µ–ø–ª–æ–π

### –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```
telegram-stars-market-bot/
‚îú‚îÄ‚îÄ src/
‚îÇ   ‚îú‚îÄ‚îÄ bot/           # Telegram Bot Module
‚îÇ   ‚îú‚îÄ‚îÄ orders/        # Orders Module
‚îÇ   ‚îú‚îÄ‚îÄ payment/       # Payment Module (YooKassa)
‚îÇ   ‚îú‚îÄ‚îÄ fragment/      # Fragment Module
‚îÇ   ‚îî‚îÄ‚îÄ shared/        # –û–±—â–∏–µ —Ç–∏–ø—ã –∏ —É—Ç–∏–ª–∏—Ç—ã
‚îú‚îÄ‚îÄ test/
‚îÇ   ‚îú‚îÄ‚îÄ e2e/           # E2E —Ç–µ—Å—Ç—ã
‚îÇ   ‚îú‚îÄ‚îÄ unit/          # Unit —Ç–µ—Å—Ç—ã
‚îÇ   ‚îî‚îÄ‚îÄ integration/   # –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ —Ç–µ—Å—Ç—ã
‚îú‚îÄ‚îÄ docker-compose.yml # –õ–æ–∫–∞–ª—å–Ω–∞—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∞
‚îú‚îÄ‚îÄ Dockerfile         # Production build
‚îî‚îÄ‚îÄ package.json
```

### –î–µ–ø–ª–æ–π

1. **–•–æ—Å—Ç–∏–Ω–≥:** DigitalOcean VPS
2. **–ö–æ–Ω—Ç–µ–π–Ω–µ—Ä–∏–∑–∞—Ü–∏—è:** Docker
3. **Database:** PostgreSQL –Ω–∞ —Ç–æ–º –∂–µ VPS –∏–ª–∏ –æ—Ç–¥–µ–ª—å–Ω—ã–π managed instance
4. **CI/CD:** GitHub Actions —Å —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—ã–º —Ä–∞–Ω–Ω–µ—Ä–æ–º
5. **–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥:** Grafana –Ω–∞ dashboard.onezee.ru

---

## –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

### –¢–∏–ø—ã —Ç–µ—Å—Ç–æ–≤

**E2E —Ç–µ—Å—Ç—ã:**
- –ü–æ–∫—Ä—ã—Ç–∏–µ –≤—Å–µ—Ö –∫—Ä–∏—Ç–∏—á–Ω—ã—Ö —Å—Ü–µ–Ω–∞—Ä–∏–µ–≤
- –ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã: Jest + Supertest
- –¢–µ—Å—Ç—ã –∑–∞–ø—É—Å–∫–∞—é—Ç—Å—è –ª–æ–∫–∞–ª—å–Ω–æ –∏ –≤ CI/CD
- –ü—Ä–∏–º–µ—Ä—ã: —Å–æ–∑–¥–∞–Ω–∏–µ –∑–∞–∫–∞–∑–∞ ‚Üí –æ–ø–ª–∞—Ç–∞ ‚Üí –ø–æ–ª—É—á–µ–Ω–∏–µ Stars

**Unit —Ç–µ—Å—Ç—ã:**
- –ü–æ–∫—Ä—ã—Ç–∏–µ –∫–ª—é—á–µ–≤—ã—Ö —Ñ—É–Ω–∫—Ü–∏–π (—Ä–∞—Å—á—ë—Ç —Ü–µ–Ω—ã, –≤–∞–ª–∏–¥–∞—Ü–∏—è, –±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞)
- –ù–µ —Ç—Ä–µ–±—É–µ—Ç—Å—è –ø–æ–ª–Ω–æ–µ –ø–æ–∫—Ä—ã—Ç–∏–µ, —Ñ–æ–∫—É—Å –Ω–∞ –∫—Ä–∏—Ç–∏—á–Ω—ã—Ö —á–∞—Å—Ç—è—Ö
- –ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã: Jest

**–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ —Ç–µ—Å—Ç—ã:**
- –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–π —Å –≤–Ω–µ—à–Ω–∏–º–∏ API (YooKassa, Fragment, Telegram)
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –º–æ–∫–æ–≤ –∏ testnet –≥–¥–µ –≤–æ–∑–º–æ–∂–Ω–æ
- –ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã: Jest

### –ó–∞–ø—É—Å–∫ —Ç–µ—Å—Ç–æ–≤

–í—Å–µ —Ç–µ—Å—Ç—ã –º–æ–∂–Ω–æ –∑–∞–ø—É—Å—Ç–∏—Ç—å –ª–æ–∫–∞–ª—å–Ω–æ:
```bash
npm run test          # Unit —Ç–µ—Å—Ç—ã
npm run test:e2e      # E2E —Ç–µ—Å—Ç—ã
npm run test:integration  # –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ —Ç–µ—Å—Ç—ã
npm run test:all     # –í—Å–µ —Ç–µ—Å—Ç—ã
```

–¢–µ—Å—Ç—ã –¥–æ—Å—Ç—É–ø–Ω—ã –≤—Å–µ–º –∂–µ–ª–∞—é—â–∏–º, —Ç–∞–∫ –∫–∞–∫ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π –ø—É–±–ª–∏—á–Ω—ã–π.

---

## –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏ –ø–æ—Å–ª–µ MVP

- Telegram Mini App (–µ—Å–ª–∏ –Ω–µ –±—ã–ª–æ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ –≤ MVP)
- –ê–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å –¥–ª—è –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞
- –†–µ—Ñ–µ—Ä–∞–ª—å–Ω–∞—è –ø—Ä–æ–≥—Ä–∞–º–º–∞
- –ü—Ä–æ–º–æ–∫–æ–¥—ã –∏ —Å–∫–∏–¥–∫–∏
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –ø–æ–ø–æ–ª–Ω–µ–Ω–∏–µ –±–∞–ª–∞–Ω—Å–∞ TON
- –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö –∞–∫–∫–∞—É–Ω—Ç–æ–≤ Fragment (–º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ)
- –û—á–µ—Ä–µ–¥–∏ –∑–∞–¥–∞—á (–µ—Å–ª–∏ –Ω–∞–≥—Ä—É–∑–∫–∞ –≤—ã—Ä–∞—Å—Ç–µ—Ç)

---

## –ü–æ–ª–µ–∑–Ω—ã–µ —Å—Å—ã–ª–∫–∏

- [Fragment](https://fragment.com)
- [Telegram Bot API](https://core.telegram.org/bots/api)

---

## –°–≤—è–∑–∞–Ω–Ω—ã–µ –¥–æ–∫—É–º–µ–Ω—Ç—ã

- [–ë–∏–∑–Ω–µ—Å-—Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è](./BUSINESS_REQUIREMENTS.md)
- [Edge Cases –∏ –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫](./EDGE_CASES.md) ‚Äî –¥–µ—Ç–∞–ª—å–Ω–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ –ø–æ–≥—Ä–∞–Ω–∏—á–Ω—ã—Ö —Å–ª—É—á–∞–µ–≤ –∏ —Å—Ü–µ–Ω–∞—Ä–∏–µ–≤ –æ–±—Ä–∞–±–æ—Ç–∫–∏ –æ—à–∏–±–æ–∫

